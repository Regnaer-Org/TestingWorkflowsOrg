AverageVelocity3Sprints =
VAR CurrentSprint = MAX(MetaRisk_GitHub_Data[sprint_name])
VAR Last3Sprints =
    CALCULATETABLE (
        VALUES(MetaRisk_GitHub_Data[sprint_name]),
        MetaRisk_GitHub_Data[sprint_name] <= CurrentSprint
    )
VAR Last3Sorted =
    TOPN(3, Last3Sprints, MetaRisk_GitHub_Data[sprint_name], DESC)
VAR IssuesClosedLast3 =
    CALCULATE (
        COUNTROWS(MetaRisk_GitHub_Data),
        MetaRisk_GitHub_Data[status] IN {"Done", "Closed"},
        MetaRisk_GitHub_Data[sprint_name] IN Last3Sorted
    )
VAR NumSprints =
    COUNTROWS(Last3Sorted)
RETURN
    DIVIDE(IssuesClosedLast3, NumSprints, 0)
