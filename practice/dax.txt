Closed Issues In Sprint By Day =
VAR SelectedSprint = SELECTEDVALUE(SprintmetaData[sprint])
VAR SelectedDate = SELECTEDVALUE('Calendar'[date])

VAR IssuesEverInSprint =
    DISTINCT (
        UNION (
            SELECTCOLUMNS(
                FILTER(MetaRisk_GitHub_Data, MetaRisk_GitHub_Data[sprint] = SelectedSprint),
                "content_id", MetaRisk_GitHub_Data[content_id],
                "ClosedDate", MetaRisk_GitHub_Data[content_closed_at]
            ),
            SELECTCOLUMNS(
                FILTER(SprintAssignments, SprintAssignments[sprint] = SelectedSprint),
                "content_id", SprintAssignments[content_id],
                "ClosedDate", LOOKUPVALUE(MetaRisk_GitHub_Data[content_closed_at], MetaRisk_GitHub_Data[content_id], SprintAssignments[content_id])
            ),
            SELECTCOLUMNS(
                FILTER(issue_changelog, issue_changelog[field] = "sprint" && issue_changelog[new_value] = SelectedSprint),
                "content_id", issue_changelog[content_id],
                "ClosedDate", LOOKUPVALUE(MetaRisk_GitHub_Data[content_closed_at], MetaRisk_GitHub_Data[content_id], issue_changelog[content_id])
            )
        )
    )

RETURN
COUNTROWS (
    FILTER (
        IssuesEverInSprint,
        NOT(ISBLANK([ClosedDate])) &&
        [ClosedDate] <= SelectedDate
    )
)
